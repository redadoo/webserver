[2024-9-9 5:43:5] start tokenization Configuration file ...
[2024-9-9 5:43:5] tokenization finished
[2024-9-9 5:43:5] start parsing token...
[2024-9-9 5:43:5] signal handling started
[2024-9-9 5:43:5] handled the signals successfully
[2024-9-9 5:43:5] start create a new epoll instance
[2024-9-9 5:43:5] init epoll instance successfully
[2024-9-9 5:43:5] Creating TCP socket...
[2024-9-9 5:43:5] add file descriptor to epoll instance ...
[2024-9-9 5:43:5] Listening on 127.0.0.1:8080
[2024-9-9 5:43:5] Creating TCP socket...
[2024-9-9 5:43:5] add file descriptor to epoll instance ...
[2024-9-9 5:43:5] Listening on 127.0.0.1:8081
[2024-9-9 5:43:5] successfully init all servers data
[2024-9-9 5:43:5] Entering event loop...
[2024-9-9 5:43:8] A client is trying to connecting to  Socket 127.0.0.1:8080
[2024-9-9 5:43:8] File descriptor set to non-blocking mode
[2024-9-9 5:43:8] Client 127.0.0.1::34336  has been accepted! by the socket: 127.0.0.1:8080
[2024-9-9 5:43:8] add file descriptor to epoll instance ...
[2024-9-9 5:43:8] Client 127.0.0.1:34336 send a request to socket 127.0.0.1:8080
[ StartRequestBlock ] 
POST /upload HTTP/1.1
Accept: */*
Content-Length: 2412
Content-Type: multipart/form-data; boundary=------------------------95835604fc648c24
Host: localhost:8080
User-Agent: curl/7.81.0

--------------------------95835604fc648c24
Content-Disposition: form-data; name="file"; filename="capiamo.conf"
Content-Type: application/octet-stream

# Web Server Configuration

# Define a server block
server {
    # Specify the host and port for the server to listen on
    listen 80;
    host 127.0.0.1;

    # Optional: Set server names
    server_name example.com www.example.com;

    # Specify the default error pages
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;

    # Limit client body size
    client_max_body_size 10M;

    # Define routes
    location / {
        # List of accepted HTTP methods
        allowed_methods GET POST;

        # Specify the root directory for the route
        root /var/www/html;

        # Optional: Define a default file to answer if the request is a directory
        index index.html;

        # Turn off directory listing
        autoindex off;
    }

    location /upload {
        # List of accepted HTTP methods
        allowed_methods POST;

        # Specify the root directory for file uploads
        root /var/www/uploads;

        # Enable file uploads and specify the directory to save them
        upload_enabled on;
        upload_directory /var/www/uploads;

        # Set a default file for the route (if it's a directory)
        index upload.html;

        # CGI execution setup
        cgi_extension .php;
        cgi_path /usr/bin/php-cgi;
    }

    location /redirect {
        # HTTP redirection
        return 301 http://www.new-example.com;
    }

    # Another route with CGI handling
    location /cgi-bin {
        # List of accepted HTTP methods
        allowed_methods GET POST;

        # Directory where CGI scripts are located
        root /var/www/cgi-bin;

        # CGI execution setup
        cgi_extension .py;
        cgi_path /usr/bin/python3;

        # Execute CGI based on file extension
        cgi_enabled on;
    }
}

# Another server block for a different host:port
server {
    listen 8080;
    host 127.0.0.1;

    # Default server for this host:port
    default_server on;

    # Error pages for this server
    error_page 403 /errors/403.html;

    # Another route example
    location /files {
        # Directory where files are served
        root /var/www/files;

        # Turn on directory listing
        autoindex on;
    }
}

--------------------------95835604fc648c24--


[ EndRequestBlock ]
[2024-9-9 5:43:8] Finding matching location for path: /upload
[2024-9-9 5:43:8] Found matching location: /upload
[2024-9-9 5:43:8] Extracted boundary: ------------------------95835604fc648c24
[2024-9-9 5:43:8] Found multipart data part of length: 2316
[2024-9-9 5:43:8] Total parts found: 1
[2024-9-9 5:43:8] Extracted 1 multipart data parts
[2024-9-9 5:43:8] Processing multipart data part 1 of 1
[2024-9-9 5:43:8] Extracted filename: capiamo.conf
[2024-9-9 5:43:8] Extracted filename: capiamo.conf
[2024-9-9 5:43:8] Extracted content: # Web Server Configuration

# Define a server block
server {
    # Specify the host and port for the server to listen on
    listen 80;
    host 127.0.0.1;

    # Optional: Set server names
    server_name example.com www.example.com;

    # Specify the default error pages
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;

    # Limit client body size
    client_max_body_size 10M;

    # Define routes
    location / {
        # List of accepted HTTP methods
        allowed_methods GET POST;

        # Specify the root directory for the route
        root /var/www/html;

        # Optional: Define a default file to answer if the request is a directory
        index index.html;

        # Turn off directory listing
        autoindex off;
    }

    location /upload {
        # List of accepted HTTP methods
        allowed_methods POST;

        # Specify the root directory for file uploads
        root /var/www/uploads;

        # Enable file uploads and specify the directory to save them
        upload_enabled on;
        upload_directory /var/www/uploads;

        # Set a default file for the route (if it's a directory)
        index upload.html;

        # CGI execution setup
        cgi_extension .php;
        cgi_path /usr/bin/php-cgi;
    }

    location /redirect {
        # HTTP redirection
        return 301 http://www.new-example.com;
    }

    # Another route with CGI handling
    location /cgi-bin {
        # List of accepted HTTP methods
        allowed_methods GET POST;

        # Directory where CGI scripts are located
        root /var/www/cgi-bin;

        # CGI execution setup
        cgi_extension .py;
        cgi_path /usr/bin/python3;

        # Execute CGI based on file extension
        cgi_enabled on;
    }
}

# Another server block for a different host:port
server {
    listen 8080;
    host 127.0.0.1;

    # Default server for this host:port
    default_server on;

    # Error pages for this server
    error_page 403 /errors/403.html;

    # Another route example
    location /files {
        # Directory where files are served
        root /var/www/files;

        # Turn on directory listing
        autoindex on;
    }
}
[2024-9-9 5:43:8] Extracted content of length: 2207
[2024-9-9 5:43:8] Uploaded file: capiamo.conf to web-page/upload/uploads/capiamo.conf
[2024-9-9 5:43:8] Attempting to send response of 265 bytes
[2024-9-9 5:43:8] Sent 265 bytes to client
[2024-9-9 5:43:8] Closing connection for client 7
[2024-9-9 5:43:11] I don't see any event within 3000 milliseconds
[2024-9-9 5:43:14] I don't see any event within 3000 milliseconds
[2024-9-9 5:43:16] ERROR: Something interrupted me!
[2024-9-9 5:43:16] Closing WebServer ...
[2024-9-9 5:43:16] all resources released and Web Server closed successfully
