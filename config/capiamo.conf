# Web Server Configuration

# Define a server block
server {
    # Specify the host and port for the server to listen on
    listen 80;
    host 127.0.0.1;

    # Optional: Set server names
    server_name example.com www.example.com;

    # Specify the default error pages
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;

    # Limit client body size
    client_max_body_size 10M;

    # Define routes
    location / {
        # List of accepted HTTP methods
        allowed_methods GET POST;

        # Specify the root directory for the route
        root /var/www/html;

        # Optional: Define a default file to answer if the request is a directory
        index index.html;

        # Turn off directory listing
        autoindex off;
    }

    location /upload {
        # List of accepted HTTP methods
        allowed_methods POST;

        # Specify the root directory for file uploads
        root /var/www/uploads;

        # Enable file uploads and specify the directory to save them
        upload_enabled on;
        upload_directory /var/www/uploads;

        # Set a default file for the route (if it's a directory)
        index upload.html;

        # CGI execution setup
        cgi_extension .php;
        cgi_path /usr/bin/php-cgi;
    }

    location /redirect {
        # HTTP redirection
        return 301 http://www.new-example.com;
    }

    # Another route with CGI handling
    location /cgi-bin {
        # List of accepted HTTP methods
        allowed_methods GET POST;

        # Directory where CGI scripts are located
        root /var/www/cgi-bin;

        # CGI execution setup
        cgi_extension .py;
        cgi_path /usr/bin/python3;

        # Execute CGI based on file extension
        cgi_enabled on;
    }
}

# Another server block for a different host:port
server {
    listen 8080;
    host 127.0.0.1;

    # Default server for this host:port
    default_server on;

    # Error pages for this server
    error_page 403 /errors/403.html;

    # Another route example
    location /files {
        # Directory where files are served
        root /var/www/files;

        # Turn on directory listing
        autoindex on;
    }
}
